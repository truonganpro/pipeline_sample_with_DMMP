"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1357],{60648:function(e,n,t){t.d(n,{Z:function(){return j}});var r=t(52322),i=t(43212),o=t(14934),s=t(55010),l=t(2784),a=t(90797),c=t(88257),d=t(54516),u=t(84046),x=t(59351),p=t(33182),h=t(88610);let j=(0,l.memo)(e=>{let{name:n,run:t,showHover:j=!1,showButton:m=!0,showSummary:f=!0}=e,{status:g}=t,y=(0,l.useMemo)(()=>{switch(g){case c.VOA.SUCCESS:return"success";case c.VOA.CANCELED:case c.VOA.CANCELING:case c.VOA.FAILURE:return"danger";default:return"none"}},[g]);return(0,r.jsxs)(o.x,{flex:{direction:"row",justifyContent:"space-between",alignItems:"flex-start",gap:16},children:[(0,r.jsxs)(o.x,{flex:{direction:"column",alignItems:"flex-start",gap:4},children:[(0,r.jsxs)(o.x,{flex:{direction:"row",alignItems:"center",gap:8},children:[(()=>{let e=(0,r.jsx)(i.V,{intent:y,children:(0,r.jsxs)(o.x,{flex:{direction:"row",alignItems:"center",gap:4},children:[(0,r.jsx)(d.K9,{status:t.status,size:10}),(0,r.jsx)(p.Zr,{run:t})]})});return j?(0,r.jsx)(s.J,{position:"top",interactionKind:"hover",content:(0,r.jsx)("div",{children:(0,r.jsx)(u.qL,{run:t,name:n})}),hoverOpenDelay:100,children:e}):e})(),f?(0,r.jsx)(p.Tw,{run:t}):null]}),f&&(x.hd.has(t.status)||x.Ys.has(t.status))?(0,r.jsx)(a.I,{runId:t.id}):void 0]}),m?(0,r.jsx)(h.A,{to:"/runs/".concat(t.id),children:"View run"}):null]})})},90797:function(e,n,t){t.d(n,{I:function(){return j}});var r=t(73235),i=t(52322),o=t(35292),s=t(39013),l=t(19126),a=t.n(l),c=t(2784),d=t(47933),u=t(20958),x=t(88257),p=t(59351);function h(){let e=(0,r._)(["\n  query StepSummaryForRunQuery($runId: ID!) {\n    pipelineRunOrError(runId: $runId) {\n      ... on Run {\n        id\n        status\n        stepStats {\n          endTime\n          stepKey\n          status\n        }\n      }\n    }\n  }\n"]);return h=function(){return e},e}let j=e=>{let{runId:n}=e,{data:t}=(0,u.aM)(m,{variables:{runId:n}}),r=null==t?void 0:t.pipelineRunOrError,l=(null==r?void 0:r.__typename)==="Run"?r.status:null,h=(0,c.useMemo)(()=>{if((null==r?void 0:r.__typename)!=="Run")return[];let{status:e}=r;return p.hd.has(e)?r.stepStats.filter(e=>e.status===x.SGm.FAILURE):p.Ys.has(e)?r.stepStats.filter(e=>e.status===x.SGm.IN_PROGRESS):[]},[r]),j=h.length;if(!j||!l)return null;if(p.hd.has(l)){if(1===j){let e=h[0],t=e.endTime?a().stringify({focusedTime:Math.floor(1e3*e.endTime)},{addQueryPrefix:!0}):"";return(0,i.jsxs)(o.YS,{color:s.$(),children:["Failed at ",(0,i.jsx)(d.rU,{to:"/runs/".concat(n).concat(t),children:e.stepKey})]})}return(0,i.jsxs)(o.YS,{color:s.$(),children:["Failed at ",(0,i.jsxs)(d.rU,{to:"/runs/".concat(n),children:[j," steps"]})]})}if(p.Ys.has(l)){if(1===j){let e=h[0],t=e.endTime?a().stringify({focusedTime:Math.floor(1e3*e.endTime)},{addQueryPrefix:!0}):"";return(0,i.jsxs)(o.YS,{color:s.$(),children:["In progress at ",(0,i.jsx)(d.rU,{to:"/runs/".concat(n).concat(t),children:e.stepKey})]})}return(0,i.jsxs)(o.YS,{color:s.$(),children:["In progress at ",(0,i.jsxs)(d.rU,{to:"/runs/".concat(n),children:[j," steps"]})]})}return null},m=(0,u.Ps)(h())},63065:function(e,n,t){t.d(n,{e:function(){return k}});var r=t(73235),i=t(52322),o=t(14934),s=t(79106),l=t(39013),a=t(37483),c=t(74159),d=t(45774),u=t(2784),x=t(20958),p=t(78491),h=t(16336),j=t(44900),m=t(4378),f=t(43250),g=t(35002),y=t(43212),b=t(88510),v=t(22921),w=t(17008),E=t(98956),I=t(50646),C=t(63485),S=t(83738),L=t(22563);let N=e=>{let{repos:n}=e,t=(0,u.useRef)(null),r=(0,u.useMemo)(()=>n.map(e=>{let{repoAddress:n}=e;return(0,L.Uz)(n)}),[n]),{expandedKeys:o,onToggle:s,onToggleAll:l}=(0,I.N)(v.y,r),a=(0,u.useMemo)(()=>{let e=[];return n.forEach(n=>{let{repoAddress:t,jobs:r}=n;e.push({type:"header",repoAddress:t,jobCount:r.length});let i=(0,L.Uz)(t);o.includes(i)&&r.forEach(n=>{let{isJob:r,name:i}=n;e.push({type:"job",repoAddress:t,isJob:r,name:i})})}),e},[n,o]),c=(0,E.w)(n.map(e=>{let{repoAddress:n}=e;return n.name})),d=(0,b.MG)({count:a.length,getScrollElement:()=>t.current,estimateSize:e=>{let n=a[e];return(null==n?void 0:n.type)==="header"?w.lo:64},overscan:10}),x=d.getTotalSize(),p=d.getVirtualItems();return(0,i.jsx)("div",{style:{overflow:"hidden"},children:(0,i.jsxs)(w.W2,{ref:t,children:[(0,i.jsx)(C.I,{}),(0,i.jsx)(w.Nh,{$totalHeight:x,children:p.map(e=>{let{index:n,key:t,size:r,start:d}=e,u=a[n];return"header"===u.type?(0,i.jsx)(S.vG,{repoAddress:u.repoAddress,height:r,start:d,onToggle:s,onToggleAll:l,expanded:o.includes((0,L.Uz)(u.repoAddress)),showLocation:c.has(u.repoAddress.name),rightElement:(0,i.jsx)(g.u,{content:1===u.jobCount?"1 job":"".concat(u.jobCount," jobs"),placement:"top",children:(0,i.jsx)(y.V,{children:u.jobCount})})},t):(0,i.jsx)(C.b,{name:u.name,isJob:u.isJob,repoAddress:u.repoAddress,height:r,start:d},t)})})]})})};var R=t(907),J=t(49455),P=t(34219),_=t(73658),O=t(8355),A=t(65822);function T(){let e=(0,r._)(["\n  query OverviewJobsQuery {\n    workspaceOrError {\n      ... on Workspace {\n        id\n        locationEntries {\n          id\n          locationOrLoadError {\n            ... on RepositoryLocation {\n              id\n              name\n              repositories {\n                id\n                name\n                pipelines {\n                  id\n                  name\n                  isJob\n                }\n              }\n            }\n            ...PythonErrorFragment\n          }\n        }\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n"]);return T=function(){return e},e}let k=()=>{let{allRepos:e,visibleRepos:n,loading:t,data:r}=(0,u.useContext)(O.C5),[p,j]=(0,m.q)({queryKey:"search",defaults:{search:""}}),g=e.length,y=(0,x.aM)($,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0}),{data:b,loading:v}=y,w=(0,h.C4)(y,h.dT),E=(0,u.useMemo)(()=>{let e=Object.values(r).filter(e=>"WorkspaceLocationEntry"===e.__typename),t=null==b?void 0:b.workspaceOrError,i=(null==t?void 0:t.__typename)==="Workspace"?t.locationEntries:e,o=(0,J.S)(n);return U(i).filter(e=>{let{repoAddress:n}=e;return o.has((0,L.Uz)(n))})},[r,b,n]),I=!b&&t;(0,P.j$)("OverviewJobs",!I);let C=p.trim().toLocaleLowerCase(),S=C.length>0,R=(0,u.useMemo)(()=>{let e=C.toLocaleLowerCase();return E.map(n=>{let{repoAddress:t,jobs:r}=n;return{repoAddress:t,jobs:r.filter(n=>{let{name:t}=n;return t.toLocaleLowerCase().includes(e)})}}).filter(e=>{let{jobs:n}=e;return n.length>0})},[E,C]),A=v&&!b;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(o.x,{padding:{horizontal:24,vertical:12},flex:{direction:"row",alignItems:"center",justifyContent:"space-between",grow:0},children:[(0,i.jsxs)(o.x,{flex:{direction:"row",gap:12,alignItems:"center"},children:[g>1?(0,i.jsx)(f.C,{}):null,(0,i.jsx)(c.oi,{icon:"search",value:p,rightElement:A?(0,i.jsx)(_.W,{tooltipContent:"Loading jobs…"}):void 0,onChange:e=>j(e.target.value),placeholder:"Filter by job name…",style:{width:"340px"}})]}),(0,i.jsx)(h.xi,{refreshState:w})]}),I&&!g?(0,i.jsx)(o.x,{padding:64,children:(0,i.jsx)(d.f,{label:"Loading jobs…"})}):(()=>{if(I)return(0,i.jsx)(o.x,{flex:{direction:"row",justifyContent:"center"},style:{paddingTop:"100px"},children:(0,i.jsxs)(o.x,{flex:{direction:"row",alignItems:"center",gap:16},children:[(0,i.jsx)(s.$,{purpose:"body-text"}),(0,i.jsx)("div",{style:{color:l.$()},children:"Loading jobs…"})]})});let t=e.length>n.length;return R.length?(0,i.jsx)(N,{repos:R}):S?(0,i.jsx)(o.x,{padding:{top:20},children:(0,i.jsx)(a.t,{icon:"search",title:"No matching jobs",description:t?(0,i.jsxs)("div",{children:["No jobs matching ",(0,i.jsx)("strong",{children:p})," were found in the selected code locations"]}):(0,i.jsxs)("div",{children:["No jobs matching ",(0,i.jsx)("strong",{children:p})," were found in your definitions"]})})}):(0,i.jsx)(o.x,{padding:{top:20},children:(0,i.jsx)(a.t,{icon:"search",title:"No jobs",description:t?"No jobs were found in the selected code locations":"No jobs were found in your definitions"})})})()]})},U=e=>{let n=e.map(e=>e.locationOrLoadError),t=[];for(let e of n)if((null==e?void 0:e.__typename)==="RepositoryLocation")for(let n of e.repositories){let{name:r,pipelines:i}=n,o=(0,A.kQ)(r,e.name),s=i.filter(e=>{let{name:n}=e;return!(0,j.pv)(n)}).map(e=>({isJob:e.isJob,name:e.name}));s.length>0&&t.push({repoAddress:o,jobs:s})}return(0,R.S)(t)},$=(0,x.Ps)(T(),p.B)},71357:function(e,n,t){t.r(n),t.d(n,{JobsRoot:function(){return d}});var r=t(52322),i=t(14934),o=t(74580),s=t(35292),l=t(63065),a=t(69737),c=t(20171);let d=()=>((0,a.Px)(),(0,c.j)("Jobs"),(0,r.jsxs)(i.x,{flex:{direction:"column"},style:{height:"100%",overflow:"hidden"},children:[(0,r.jsx)(o.m,{title:(0,r.jsx)(s.X6,{children:"Jobs"})}),(0,r.jsx)(l.e,{})]}));n.default=d},907:function(e,n,t){t.d(n,{S:function(){return i}});var r=t(22563);let i=e=>[...e].sort((e,n)=>{let t=(0,r.Uz)(e.repoAddress),i=(0,r.Uz)(n.repoAddress);return t.localeCompare(i)})},49455:function(e,n,t){t.d(n,{S:function(){return o}});var r=t(65822),i=t(22563);let o=e=>new Set(e.map(e=>(0,i.Uz)((0,r.kQ)(e.repository.name,e.repositoryLocation.name))))},84046:function(e,n,t){t.d(n,{JH:function(){return f},qL:function(){return g}});var r=t(52322),i=t(14934),o=t(55010),s=t(35292),l=t(39013),a=t(74188),c=t(47933),d=t(35505),u=t(54516),x=t(67994),p=t(59351),h=t(33182),j=t(90797);let m=e=>{let{status:n,opacity:t=1}=e,i=x.YM[n];return(0,r.jsx)(E,{$color:i,$opacity:t})},f=e=>{let{fade:n,jobName:t,runs:s}=e,l=s.length,a=.8/Math.max(3,l);return(0,r.jsx)(i.x,{flex:{direction:"row",alignItems:"center",gap:2},children:s.map((e,i)=>(0,r.jsx)(o.J,{position:"top",interactionKind:"hover",content:(0,r.jsx)("div",{children:(0,r.jsx)(g,{run:e,name:t})}),hoverOpenDelay:100,children:(0,r.jsx)(m,{runId:e.id,status:e.status,opacity:n?1-(l-i-1)*a:1},e.id)},e.id))})},g=e=>{let{name:n,run:t}=e;return(0,r.jsxs)(y,{children:[(0,r.jsx)(b,{children:n}),(0,r.jsxs)(v,{children:[(0,r.jsxs)(i.x,{flex:{alignItems:"center",direction:"row",gap:8},children:[(0,r.jsx)(u.K9,{status:t.status}),(0,r.jsx)(c.rU,{to:"/runs/".concat(t.id),children:(0,r.jsx)(s.aU,{children:(0,h.EI)(t)})})]}),(0,r.jsxs)(i.x,{flex:{direction:"column",gap:4},children:[(0,r.jsx)(h.Zr,{run:t}),(0,r.jsx)(h.Tw,{run:t})]})]}),p.hd.has(t.status)||p.Ys.has(t.status)?(0,r.jsx)(w,{children:(0,r.jsx)(j.I,{runId:t.id})}):null]})},y=d.ZP.div.withConfig({componentId:"sc-59d147fc-0"})(["padding:4px;font-size:12px;width:220px;"]),b=d.ZP.div.withConfig({componentId:"sc-59d147fc-1"})(["padding:8px;box-shadow:inset 0 -1px ",";font-family:",";font-size:14px;font-weight:500;color:",";max-width:100%;text-overflow:ellipsis;overflow:hidden;min-width:0px;"],l.wL(),a.b.default,l.Ep()),v=d.ZP.div.withConfig({componentId:"sc-59d147fc-2"})(["padding:8px;display:flex;align-items:flex-start;justify-content:space-between;"]),w=d.ZP.div.withConfig({componentId:"sc-59d147fc-3"})(["overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding:4px 8px 8px;:empty{display:none;}"]),E=d.ZP.div.withConfig({componentId:"sc-59d147fc-4"})(["background-color:",";border-radius:2px;height:16px;opacity:",";width:8px;"],e=>{let{$color:n}=e;return n},e=>{let{$opacity:n}=e;return n})},73658:function(e,n,t){t.d(n,{W:function(){return c}});var r=t(52322),i=t(2784);let o=e=>{let[n,t]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{let n=setTimeout(()=>t(!0),e);return()=>clearTimeout(n)},[e]),n};var s=t(14934),l=t(35002),a=t(79106);let c=e=>{let{tooltipContent:n}=e;return o(2e3)?(0,r.jsx)(s.x,{margin:{top:1},children:(0,r.jsx)(l.u,{placement:"top",canShow:!!n,content:n||"",children:(0,r.jsx)(a.$,{purpose:"body-text"})})}):null}},63485:function(e,n,t){t.d(n,{I:function(){return F},b:function(){return M}});var r=t(73235),i=t(52322),o=t(53664),s=t(14934),l=t(2784),a=t(47933),c=t(35505),d=t(83738),u=t(92199),x=t(10539),p=t(20958),h=t(16336),j=t(60603),m=t(79106),f=t(55010),g=t(35002),y=t(38491),b=t(29467),v=t(36803),w=t(32177),E=t(51701),I=t(88257),C=t(83846),S=t(42519),L=t(43);function N(){let e=(0,r._)(["\n  query RunReExecutionQuery($runId: ID!) {\n    pipelineRunOrError(runId: $runId) {\n      ... on Run {\n        id\n        status\n        pipelineName\n        executionPlan {\n          artifactsPersisted\n          ...ExecutionPlanToGraphFragment\n        }\n      }\n    }\n  }\n  ","\n"]);return N=function(){return e},e}let R=e=>{let{job:n,isAssetJob:t,repoAddress:r}=e,o=n.runs.length?n.runs[0]:null,s={pipelineName:n.name,repositoryName:r.name,repositoryLocationName:r.location},a=(0,w.DO)(n.name),c=(0,S.D)(),{permissions:{canLaunchPipelineReexecution:d,canLaunchPipelineExecution:u},disabledReasons:h}=(0,v.xz)(r.location),[E,N]=(0,p.td)(J),{data:R}=N,P=(0,l.useCallback)(()=>{(null==o?void 0:o.id)&&E({variables:{runId:o.id}})},[o,E]),_=(null==R?void 0:R.pipelineRunOrError.__typename)==="Run"?null==R?void 0:R.pipelineRunOrError:null,O="loading"===t?(0,i.jsx)(j.sN,{icon:"execute",text:"Loading...",disabled:!0}):!0===t?(0,i.jsx)(j.sN,{icon:a.loading?(0,i.jsx)(m.$,{purpose:"caption-text"}):"execute",text:"Launch new run",disabled:!u,onClick:e=>a.onClick(s,e)}):(0,i.jsx)(L.U,{icon:"execute",text:"Launch new run",disabled:!u,to:(0,x.jT)({repoName:r.name,repoLocation:r.location,pipelineName:n.name,isJob:n.isJob,path:"/playground"})}),A=(0,i.jsx)(j.sN,{icon:"replay",text:"Re-execute latest run",onClick:()=>_?c(_,I.hmq.ALL_STEPS):void 0,disabled:!d||!_||!(0,C.EP)(_)}),T=(0,i.jsx)(j.sN,{icon:"sync_problem",text:"Re-execute latest run from failure",onClick:()=>_?c(_,I.hmq.FROM_FAILURE):void 0,disabled:!d||!_||!(0,C.VM)(_)});return(0,i.jsxs)(i.Fragment,{children:[a.launchpadElement,(0,i.jsx)(f.J,{onOpened:()=>P(),content:(0,i.jsxs)(j.v2,{children:[(0,i.jsx)(L.U,{to:(0,x.jT)({repoName:r.name,repoLocation:r.location,pipelineName:n.name,isJob:n.isJob}),icon:"job",text:"View job"}),(0,i.jsx)(L.U,{to:(0,x.jT)({repoName:r.name,repoLocation:r.location,pipelineName:n.name,isJob:n.isJob,path:"/runs"}),icon:"checklist",text:"View all recent runs"}),u?O:(0,i.jsx)(g.u,{content:h.canLaunchPipelineExecution,display:"block",children:O}),d?A:(0,i.jsx)(g.u,{content:h.canLaunchPipelineReexecution,display:"block",children:A}),d?T:(0,i.jsx)(g.u,{content:h.canLaunchPipelineReexecution,display:"block",children:T})]}),position:"bottom-left",children:(0,i.jsx)(y.zx,{icon:(0,i.jsx)(b.JO,{name:"expand_more"})})})]})},J=(0,p.Ps)(N(),E.$);var P=t(60648),_=t(74283),O=t(84046),A=t(33182),T=t(4219),k=t(60918),U=t(17008);function $(){let e=(0,r._)(["\n  query SingleJobQuery($selector: PipelineSelector!) {\n    pipelineOrError(params: $selector) {\n      ... on Pipeline {\n        id\n        name\n        isJob\n        isAssetJob\n        description\n        runs(limit: 5) {\n          id\n          ...RunTimeFragment\n        }\n        schedules {\n          id\n          ...ScheduleSwitchFragment\n        }\n        sensors {\n          id\n          ...SensorSwitchFragment\n        }\n      }\n    }\n  }\n\n  ","\n  ","\n  ","\n"]);return $=function(){return e},e}let q="1.5fr 1fr 180px 96px 80px",M=e=>{let{name:n,isJob:t,repoAddress:r,start:c,height:j}=e,[m,f]=(0,p.td)(Z,{variables:{selector:(0,u._T)(r,n)}});(0,d.v5)(m),(0,h.C4)(f,h.dT);let{data:g}=f,y=(null==g?void 0:g.pipelineOrError.__typename)==="Pipeline"?null==g?void 0:g.pipelineOrError:void 0,{schedules:b,sensors:v}=(0,l.useMemo)(()=>{if(y){let{schedules:e,sensors:n}=y;return{schedules:e,sensors:n}}return{schedules:[],sensors:[]}},[y]),w=(0,l.useMemo)(()=>{if(y){let{runs:e}=y;if(e.length)return[...e]}return[]},[y]);return(0,i.jsx)(U.X2,{$height:j,$start:c,children:(0,i.jsxs)(z,{border:"bottom",children:[(0,i.jsxs)(U.E5,{children:[(0,i.jsx)("div",{style:{maxWidth:"100%",whiteSpace:"nowrap",fontWeight:500},children:(0,i.jsx)(a.rU,{to:(0,x.$U)(r,"/jobs/".concat(n)),children:(0,i.jsx)(o.g,{text:n})})}),(0,i.jsx)(d.HB,{children:(null==y?void 0:y.description)||""})]}),(0,i.jsx)(U.E5,{children:b.length||v.length?(0,i.jsx)(s.x,{flex:{direction:"column",alignItems:"flex-start",gap:8},children:(0,i.jsx)(V,{children:(0,i.jsx)(_.I,{schedules:b,sensors:v,repoAddress:r})})}):(0,i.jsx)(d.mq,{queryResult:f})}),(0,i.jsx)(U.E5,{children:w[0]?(0,i.jsx)(P.Z,{run:w[0],showButton:!1,showHover:!0,showSummary:!1,name:n}):(0,i.jsx)(d.mq,{queryResult:f})}),(0,i.jsx)(U.E5,{children:w.length?(0,i.jsx)(s.x,{padding:{top:4},children:(0,i.jsx)(O.JH,{jobName:n,runs:[...w].reverse(),fade:!0})}):(0,i.jsx)(d.mq,{queryResult:f})}),(0,i.jsx)(U.E5,{children:(0,i.jsx)(s.x,{flex:{justifyContent:"flex-end"},style:{marginTop:"-2px"},children:(0,i.jsx)(R,{job:{name:n,isJob:t,runs:w},isAssetJob:y?y.isAssetJob:"loading",repoAddress:r})})})]})})},F=()=>(0,i.jsxs)(U.VJ,{templateColumns:q,sticky:!0,children:[(0,i.jsx)(U.qN,{children:"Name"}),(0,i.jsx)(U.qN,{children:"Schedules/sensors"}),(0,i.jsx)(U.qN,{children:"Latest run"}),(0,i.jsx)(U.qN,{children:"Run history"}),(0,i.jsx)(U.qN,{})]}),z=(0,c.ZP)(s.x).withConfig({componentId:"sc-b0d21794-0"})(["display:grid;grid-template-columns:",";height:100%;"],q),V=c.ZP.div.withConfig({componentId:"sc-b0d21794-1"})(["width:100%;> .bp4-popover2-target{width:100%;}"]),Z=(0,p.Ps)($(),A.$X,T.J,k.U)}}]);
//# sourceMappingURL=1357.24c3f7ab0108887b.js.map